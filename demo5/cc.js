var b=document.getElementById("iGS");function h(a){b.N.push(a);return a}function m(a,c){b.C[a].push({action:c,position:b.F})}function n(a){if(0>a)return 0;var c=Math.floor(a);a=a-c;c=b.S[c];return c.altitude+(1-a)*c.v+a*c.m}
function aa(a){window.requestAnimationFrame(aa);if(b.g&&!b.wa){b.qa?b.u=a-b.Ea:(b.qa=a,b.u=100);b.Ea=a;b.Ja=a-b.qa;for(a=0;a<b.i.length;a+=1)b.i[a].la();b.aa=-b.g.c+b.$/2;b.Fa=-b.g.j+10;0==b.pa&&0<b.C[0].length&&b.C[0][0].position<b.g.c&&(a=b.C[0].shift(),a.action());1==b.pa&&0<b.C[1].length&&b.C[1][b.C[1].length-1].position>b.g.c&&(a=b.C[1].pop(),a.action());for(a=0;a<b.i.length;a+=1){var c=b.i[a];c.style.left=(c.c+b.aa)*b.X*c.O+"px";c.style.bottom=(c.j+b.Fa)*b.ka*c.ga+"px"}30>b.g.j?(b.R=30,b.oa=
5):(b.R=50,b.oa=2);if(Math.abs(b.aa-b.xa)>.8*b.T){a=[];for(c=0;c<b.N.length;c+=1){var f=b.N[c],d=(f.c+b.aa)*f.O;d+f.ha>-b.T&&d<b.$+b.T&&a.push(f)}for(c=0;c<a.length;c+=1)b.N.splice(b.N.indexOf(a[c]),1),b.appendChild(a[c]),b.i.push(a[c]);a=[];for(c=0;c<b.i.length;c+=1)f=b.i[c],d=(f.c+b.aa)*f.O,(d+f.ha<-b.T||d>b.$+b.T)&&a.push(f);for(c=0;c<a.length;c+=1)b.i.splice(b.i.indexOf(a[c]),1),b.removeChild(a[c]),b.N.push(a[c]);b.xa=b.aa}}}
function ba(a){b.wa=1;a?(p(0),q(b.level.title+": COMPLETED\n"),q("Score "+b.W),q("\n<a href='#' onclick='start("+b.ya+1+",0)'>[NEXT TASK]</a>")):(p(0),q(b.level.title+": FAILED\n"),q("Final Score "+b.W),q("\n<a href='#' onclick='mainMenu()'>[MAIN MENU]</a>"),q("\n<a href='#' onclick='start("+b.ya+",1)'>[RESTART FROM"+b.level.title+"]</a>"))}function ca(){m(1,function(){ba(1)})}
window.fOL=function(){var a=document.getElementById("iMM");b.X=a.clientWidth;b.ka=a.clientHeight;b.ua=b.ka/b.X;b.$=b.offsetWidth/b.X;p(0);q("CARGO-72\n");q("..an invasion is only\n   as good as its supply line..\n");q("<a onclick='start(0,1)' href='#'>[Play from Start]</a>\n");q("a game by elementalsystems\n   for twelvegamesayear\n");window.requestAnimationFrame(aa)};
window.start=function(a,c){c&&(b.W=0);b.ya=a;var f=da[a];p(1);if(b.i)for(var d=0;d<b.i.length;d+=1)b.removeChild(b.i[d]);b.i=[];b.N=[];b.pa=0;b.C=[[],[]];b.level=f;b.S=[];b.o=0;b.Ca=0;b.F=0;b.b=0;b.ja=-99999;b.w=99999;b.xa=1E5;b.T=30;b.qa=0;b.R=30;b.oa=5;b.wa=0;ea();for(d=0;d<f.content.length;d+=1)for(var k=f.content[d].ca?b.o+f.content[d].ca:0,e=ga(f.content[d].set),g=null;;)if(g=k?e.Da():e.next(),g(),k){if(b.o>k)break}else if(e.ra())break;document.getElementById("iTT").innerHTML="Task: "+f.title;
for(d=0;d<f.sa.length;d+=1)q(f.sa[d]);return!1};var ha=[{a:"cPT"},{pattern:"#+",a:"cTS"},{pattern:"#+",ta:"@&#%$"},{pattern:"[!]+",a:"cTD"}],ia=[{a:"cST"},{Aa:.8},{pattern:"#+",ta:"  o .  ' , "}],r=[{pattern:"(\\S+ {0,5})*\\S",a:"cBS"},{pattern:"\\*.+\\*",a:"cBT"},{pattern:"[\\[\\]o]+",a:"cBW"}],ja={I:"                   O   + o ;                  _|___|/_;                  }''o..{;                    |=|;|::::::::::::::::::/==|  ;L_________________/===|;|============CARGO-72==\\;|=(( ))==(( ))==(( ))==/;    V      V      V     ; ".split(";"),
a:"cAB",B:[{pattern:"=(.*=)*",a:"cAS"},{pattern:"\\}.*\\{",a:"cAS"}]},u={I:["  nnnnn  "," <#####>","<##(O)##>"," <#####>","  uuuuu  "],a:"cAW",B:[{pattern:"#+",a:"cWS"},{pattern:"\\(O\\)",a:"cWH"}]},v={I:"     |    ; +===+===+;<| [] [] |>; +===+===+;     |;     |;    + +;    |o|;    + +;     |;     |; ___/ \\___".split(";"),a:"cBB",B:r,P:5,V:9,ia:3},ka={I:"****************;*rrrrrrrrrrrrrr*;****************;X              X;+==============+====+;| []   []   []   [] |;|'''''''''''''''''''|;|rrrrrrrrrrrrrr ___ |;|   .     .     ___ |;| .XXX'.'XXX.    '  |;| XXXXX|XXXXX   o   |;| XXXXX|XXXXX     o |;| XXXXX|XXXXX ______|".split(";"),
a:"cBB",B:r,K:16,J:19,U:10,P:5,V:6,ia:3},w={I:["***","*1*","***","X X"],a:"cBB",B:r,K:1,J:1,U:20,P:3,V:3,ia:5},la={I:["  .+. ",":#111#","  '+' "],a:"cCT",B:[{pattern:"\\S+",a:"cCS"}],K:3,J:3,U:8},ma={I:["T=T","| |","| |","X X"],a:"cBB",B:r,K:1,J:1,U:12};var x=[];function ea(){b.onkeydown=function(a){x[a.keyCode]=1};b.onkeyup=function(a){x[a.keyCode]=0};b.focus()};function y(a,c){return Math.floor(a+(c-a+1)*Math.random())}function na(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function z(a,c,f){var d=a.classList.contains(c);f&&!d?a.classList.add(c):!f&&d&&a.classList.remove(c)}
function ga(a){var c={};c.source=a;c.current=[];c.ra=function(){return!this.current.length};c.next=function(){this.ra()&&(this.current=this.source.slice());return c.current.shift()};c.Da=function(){this.ra()&&(this.current=this.source.slice());return c.current.splice(y(0,this.current.length-1),1)[0]};return c};function B(){C("_",10,1)}function D(){C("_",20,1)}function E(){C("_",50,1)}function F(){C("_",y(5,15),1)}function G(){H(y(5,10),1)}function oa(){H(y(-5,-10),1)}function I(){C("//",y(3,8),1)}function pa(){C("\\",y(3,8),1)}function J(){C("_,:,_",y(5,10),1)}function K(){C("_,--,___",6,1)}function L(){C("_,--,_____",15,1)}function M(){C("!",y(3,8),1)}function N(){O(15);C("_",10,1);O(-15)}function qa(){C("_",10);O(y(1,5));C("_",10,1)}function P(){Q(20,y(20,30))}function R(){Q(40,y(20,30))}
function ra(){Q(0,y(10,20))}function sa(){C("_",10,0);O(3);C("111111",6,0);O(-3);C("_",20,1,null,[{pattern:"1+",replace:"*JUMP*",a:"cBR"}])}function ta(){var a=y(3,6);C("_",10,0);O(a);C("111111",6,0);O(-a);C("_",20,1,null,[{pattern:"1+",replace:"*JUMP*",a:"cBR"}])}function S(){var a=y(5,12);H(a,0);H(-a,1,ia)}
function ua(){var a=T(ja,5,5);b.g=a;a.la=va;a.f=0;a.L=0;a.h=[T(u,0,0),T(u,0,0),T(u,0,0)];a.ma=[-3,0,3];a.A=0;a.s=0;a.D=a.c;a.l=a.j;a.Y=0;a.Ba=3.14;a.G=0;a.h[0].Z=a.h[1].Z=a.h[2].Z=0;a.H=0;wa(0)}function U(){T(v,y(-5,5),y(0,-3))}function V(){T(v,y(-5,5),y(0,-3),null,0,1);T(v,y(0,10),y(0,-3),null,0,2);T(v,y(5,15),y(0,-3),null,0,3)}function xa(){T(ka,0,0,[{pattern:"r+",replace:" ASSEMBLY X18 ",a:"cBR"}])}function ya(){T(ka,0,0,[{pattern:"r+",replace:" OUT-EYE-8     ",a:"cBR"}],1,6)}
function za(){T(ma,0,0);var a=T(la,0,2.5,[{pattern:"1+",replace:" STD-UNIT  "}]);Aa(a)}function Ba(){Ca(30,-30,"cSS")}function Da(){Ea();ca()}
var da=[{title:"QA:MARINE",sa:["Unit CARGO-72...Online...","SYS-CHK-SUM: OKAY","Status: Unit Ready","Proceed to Test Zone","Use [D] to move rightwards."],content:[{set:[N,Ba,B,xa,B,S,Da,ua,E,V,K,B,K,S,E,U,B]},{set:[I,B,function(){T(w,0,0,[{pattern:"1+",replace:" QA: Yard Tests ",a:"cBR"}])},function(){W(0,"LIVE-ENV QA Test: INIT");W(0,"Use <i>[A]</i> + <i>[D]</i> to control the buggy")},D,V,L,D,pa,D,I,B,function(){W(0,"Press [Space] to Jump")},D,sa,ta,L,function(){W(0,"HAZ-INFO: Terrain Dangerous");
W(0,"Danger zones can damage you.")},E,M,E,M,E,function(){T(w,0,0,[{pattern:"1+",replace:" QA: Offroad Track ",a:"cBR"}])},D]},{set:[ra,J,function(){var a=y(5,10);H(a,0);H(-a,1)},function(){var a=y(2,5);H(a,0);H(-a,1)},S,qa,oa,F,M,ta],ca:400},{set:[ra,J,ra,B,U,E,function(){W(1,"You are slower in reverse.");W(1,"Some obstacles will be harder.")},D,za,B,ya,E,N]}]},{title:"QA:ATMOS",sa:["QA:ATMOS: INIT","Ascend to Atmospheric\n testing ground."],content:[{set:[N,Ba,function(){Ca(90,30,"cAS")},B,xa,B,
S,Da,ua,E,V,K,B,K,S,E,U,B]},{set:[P,P,P,G,oa,J],ca:200},{set:[G,G,R,S,U,D,function(){T(w,0,0,[{pattern:"1+",replace:" QA: Atmos Track ",a:"cBR"}])},L,function(){W(0,"ENV-INFO: In Atmospshere");W(0,"There is less drag out of water.");W(0,"But gravity affects the you more.")},F]},{set:[F,I,pa,R,U,F,sa,ta,qa,M,V],ca:400},{set:[R,R,B,U,E,za,B,ya,D,N]}]}];function C(a,c,f,d,k){for(var e=0;e<c;e+=1)X(a.charAt(e%(a.length-1)));f&&Fa(d,k)}function H(a,c,f){Ga(a,c,f,function(a){return 3*a*a-2*a*a*a})}function Ga(a,c,f,d){var k=y(15,55),e=b.b;for(i=0;i<k;i+=1){var g=d(i/k)*a,l=Math.floor(g),g=g-l;b.b=e+l;l="";l=.75<g?"'":.5<g?"-":.25<g?".":"_";X(l)}.8<g&&(b.b+=1);c&&Fa(f)}
function Fa(a,c){b.w-=20;var f=Math.floor(b.ja-b.w+1),d=document.createElement("DIV"),k=b.F-b.o;z(d,"cGO",!0);d.M=[];for(var e=0;e<f;e+=1){d.M[e]="";for(var g=0;g<k;g+=1){var l=b.S[g+b.o].altitude-b.w;d.M[e]=e==l?d.M[e]+b.S[g+b.o].symbol:e<l?d.M[e]+"#":d.M[e]+" "}}d.c=b.o;d.ha=b.F-b.o;d.j=b.w;d.va=b.w+f;k="";for(e=f-1;0<=e;--e)k+="<div>"+na(d.M[e])+"</div>";d.innerHTML=k;d.la=Ha;d.O=d.ga=1;Y(d,a?a:ha);c&&Y(d,c);h(d);d.za?(b.F=b.o,b.b=b.Ca):(b.o=b.F,b.Ca=b.b);b.ja=-99999;b.w=99999}
function O(a){b.b+=a}function X(a){a={v:0,m:0,symbol:a,H:0};switch(a.symbol){case "\\":a.v=1;break;case "/":a.m=1;break;case ",":a.m=.2;break;case ":":a.v=a.m=.6;break;case "1":a.v=a.m=1;break;case ".":a.v=a.m=.2;break;case "-":a.v=a.m=.5;break;case "'":a.v=a.m=.8;break;case "W":case "!":a.v=a.m=1,a.H=100}b.b-=Math.floor(a.v);a.altitude=Math.floor(b.b);b.b>b.ja&&(b.ja=b.b);b.b<b.w&&(b.w=b.b);b.b+=Math.floor(a.m);b.S[b.F]=a;b.F+=1}
function Q(a,c){for(var f=0;f<c;f+=1){var d=a-b.b;switch(y(0,Math.abs(d+6))){case 0:case 1:case 2:case 3:X("_");break;case 4:X("/");break;case 5:X("\\");break;default:X(0<d?"/":"\\")}}Fa(void 0)}function Ha(){}function Ca(a,c,f){var d=document.createElement("DIV");z(d,"cGO",!0);z(d,f,!0);d.c=5;d.ha=b.$;d.j=c;d.va=a;d.O=0;d.ga=1;d.la=Ha;d.za=1;d.style.height=(a-c)*b.ka;d.style.width=b.$*b.X;h(d)};var Z=document.getElementById("iTC"),Ia=document.getElementById("iDI"),Ja=document.getElementById("iSC");function p(a){Z.ea=[];Z.fa=[];Z.da=[];z(document.body,"play",a);Z.na="";Z.position=-1;Z.time=0;Z.content="";Z.remove=a;Ka()}function q(a){Z.fa.push(a)}function Ka(){Z.content="";for(var a=0;a<Z.ea.length;a+=1)Z.content+=Z.ea[a]+"\n";Z.innerHTML=Z.content}
function La(){var a=50;0>Z.position?(Z.fa.length&&(Z.na=Z.fa[0].replace(/<.+?>/g,""),Z.position=0,a=500),Z.da.length&&Z.remove&&Z.da[0]<Z.time&&(Z.ea.shift(),Z.da.shift(),Ka(),a=200)):(Z.innerHTML=Z.content+Z.na.substring(0,Z.position)+"_",Z.position+=1,Z.position==Z.na.length&&(Z.ea.push(Z.fa.shift()),Z.da.push(Z.time+5E3),Ka(),Z.position=-1));Z.time+=a;setTimeout(La,a)}p(1);La();function W(a,c){m(a,function(){q(c)})}function wa(a){b.g.H+=a;Ia.style.width=b.g.H.toFixed(1)+"%";100<b.g.H&&ba(0)}
function Ma(a,c){q("Score +"+c.toFixed(0)+"("+a+")");b.W+=c;Ja.innerHTML="SCORE "+b.W}function Ea(){m(1,function(){Ma("Mission Completed",1E3)})};function Y(a,c){for(var f=a.getElementsByTagName("DIV"),d=0;d<f.length;d+=1){for(var k=f[d].innerHTML,e=0;e<c.length;e+=1)c[e].pattern?k=k.replace(new RegExp(c[e].pattern,"g"),function(a){if(c[e].replace){a=a.length;for(var d="";d.length<a;)d+=c[e].replace;a=d.substring(0,a)}else if(c[e].ta){for(var d=c[e].ta,f="";f.length<a.length;)f+=d.charAt(y(0,d.length));a=f}c[e].a&&(a="<span class="+c[e].a+">"+a+"</span>");return a}):(c[e].a&&z(a,c[e].a,!0),c[e].Aa&&(a.O=a.ga=c[e].Aa,a.za=1));f[d].innerHTML=
k}}
function T(a,c,f,d,k,e){!k&&a.U&&(k=a.U);!e&&a.ia&&(e=a.ia);var g=a.I.slice();if(k){a.K||(a.K=0);a.J||(a.J=g[0].length-1);for(var l=0;l<g.length;l+=1){for(var A=g[l].substring(a.K,a.J+1),fa=A,t=0;t<k-1;t+=1)fa+=A;g[l]=g[l].substring(0,a.K)+fa+g[l].substring(a.J+1)}}if(e)for(a.P||(a.P=0),a.V||(a.V=g.length-1),t=0;t<e-1;t+=1)Array.prototype.splice.apply(g,[a.P,0].concat(g.slice(a.P,a.V+1)));k=g.length;e=document.createElement("DIV");l=0;z(e,"cGO",!0);z(e,a.a,!0);e.c=b.o+c;e.j=b.b+f;e.va=b.b+k+f;c="";
for(t=0;t<k;t+=1)l<g[t].length&&(l=g[t].length),c+="<div>"+na(g[t])+"</div>";e.ha=l;e.innerHTML=c;e.O=e.ga=1;a.B&&Y(e,a.B);d&&Y(e,d);e.la=Ha;return h(e)};function va(){this.Y=0;x[68]&&(this.Y=120);x[65]&&(this.Y=-100);var a=x[32];this.L>this.f?(this.f+=this.Ba*b.u/1E3,this.f>this.L&&(this.f=this.L)):this.L<this.f&&(this.f-=this.Ba*b.u/1E3,this.f<this.L&&(this.f=this.L));var c=Math.cos(this.f),f=Math.sin(this.f),d=this.A*b.u/1E3,k=this.s*b.u/1E3;this.D+=d;this.l+=k;for(var e=1E3,g=0;3>g;g+=1){var l=this.D+1*f+c*this.ma[g],A=this.l-1+(1*c-f*this.ma[g])/b.ua-n(l);.25>A&&(this.h[g].Z+=this.speed/5*b.u/1E3);0>A&&(l=(0>l?{}:b.S[Math.floor(l)]).H)&&wa(l*
b.u/1E3);e>A&&(e=A)}-1.5>e?(this.D-=d,this.l-=k,this.A*=-.1,this.s=0):0>e?(0>this.s&&(this.s=0),this.l-=e,this.G=1):this.G=0;0<this.G&&a&&(this.s+=20);for(g=0;3>g;g+=1)this.h[g].c=this.D-1.5+1*f+c*this.ma[g],this.h[g].j=this.l-1+(1*c-f*this.ma[g])/b.ua,this.h[g].style.transform="rotate("+this.h[g].Z+"rad)";this.c=this.D-5;this.j=this.l;this.style.transform="rotate("+this.f.toFixed(3)+"rad)";this.ba&&(l=this.D+3*f-5*c,a=this.l+(3*c+5*f)/b.ua,this.ba.c=l,this.ba.j=a,this.ba.style.transform="rotate("+
this.f.toFixed(3)+"rad)");this.A+=(this.Y*this.G*c-b.oa*this.G*this.A+this.G*f*b.R)*b.u/1E3;this.s+=(-this.Y*this.G*f-b.R+this.G*c*b.R*.7)*b.u/1E3;this.speed=Math.sqrt(this.A*this.A+this.s*this.s);0>this.A&&(this.speed*=-1);.25>e&&(this.L=Math.atan2((n(this.h[0].c+1.5)-n(this.h[2].c+1.5))*b.ka,(this.h[2].c-this.h[0].c)*b.X))}function Aa(a){m(0,function(){q("Cargo Loaded.");b.g.ba=a;b.g.Ha=a.c;b.g.Ia=a.j;b.g.Ga=0;Ma("CARGO-SAFE",500);b.pa=1;q("Return to base.")})};
